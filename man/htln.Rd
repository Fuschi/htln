% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/htln.R
\name{htln}
\alias{htln}
\alias{mle_htln}
\alias{dhtln}
\alias{qhtln}
\alias{rhtln}
\title{Hurdle Truncated Log-Normal Model}
\usage{
mle_htln(y, warning.silent = TRUE)

dhtln(x, phi = 0, meanlog = 0, sdlog = 1, a = 0, b = Inf)

qhtln(p, phi = 0, meanlog = 0, sdlog = 1, a = 0, b = Inf, integer = TRUE)

rhtln(n, phi = 0, meanlog = 0, sdlog = 1, a = 0, b = Inf, integer = TRUE)
}
\arguments{
\item{y}{numeric vector on the original scale (non-negative), used for
parameter estimation. Internally transformed as \code{log1p(y)}.}

\item{warning.silent}{logical. If \code{TRUE}, suppress warning messages
from \code{\link[MASS]{fitdistr}} during the MLE optimization.}

\item{x}{vector of quantiles on the log-transformed scale
(i.e., values of \eqn{Z = \log(Y + 1)}).}

\item{phi}{probability mass at zero (hurdle component), \eqn{P(Y = 0)}.}

\item{meanlog}{mean of \eqn{Z = \log(Y + 1)} on the log scale.}

\item{sdlog}{standard deviation of \eqn{Z = \log(Y + 1)} on the log scale.}

\item{a}{lower bound for the truncation interval on the log scale.}

\item{b}{upper bound for the truncation interval on the log scale.}

\item{p}{vector of probabilities.}

\item{integer}{logical (default \code{TRUE}). If \code{TRUE}, values
on the original scale are coerced to integers: positive values in
\code{(0, 1)} are set to 1 and all values are rounded.}

\item{n}{number of observations to generate.}
}
\value{
\itemize{
\item \code{mle_htln()} returns a list with components
\code{estimate}, \code{loglik} and \code{success}.
\item \code{dhtln()} returns the density evaluated at \code{x}.
\item \code{qhtln()} returns the quantiles for probabilities \code{p}.
\item \code{rhtln()} returns random draws from the hurdle truncated
log-normal model, on the original scale (after inverse \code{log1p}).
}
}
\description{
Functions to fit and work with a hurdle model whose continuous component
follows a truncated log-normal distribution.

The model is tailored for non-negative data with many zeros and heavy tails,
such as NGS counts after a \code{log(x + 1)} transformation. Let
\eqn{Y} denote the original-scale data (e.g. counts) and
\eqn{Z = \log(Y + 1)}. The distribution is
\deqn{
  P(Y = 0) = \phi, \qquad
  Z \mid (Y > 0) \sim \mathrm{TruncNorm}(\mu, \sigma^2; [a, b]),
}
where \eqn{\phi} is the probability of an excess zero (hurdle component)
and \eqn{Z} is truncated to the interval \code{[a, b]} on the log scale.

On the original scale, \code{a} and \code{b} correspond to truncation
bounds applied to \eqn{Z = \log(Y + 1)}, not directly to \eqn{Y}.
}
\seealso{
\code{\link[truncnorm]{dtruncnorm}},
\code{\link[truncnorm]{qtruncnorm}}, \code{\link[truncnorm]{rtruncnorm}},
\code{\link[MASS]{fitdistr}}
}
